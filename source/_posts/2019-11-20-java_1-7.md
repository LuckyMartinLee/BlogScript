---
title: Java 性能优化的若干原则
date: 2020-03-14 14:16:21
tags:
- Java
---

##　正确使用基本数据类型和其包装类类型

虽然包装类型和基本类型在使用过程中是可以相互转换，但它们两者所产生的内存区域是完全不同的，基本类型数据产生和处理都在栈中处理，而包装类型是对象，是在堆中产生实例。在集合类对象，有对象方面需要的处理适用包装类型，其他的情况，建议提倡使用基本类型。

## 善用 ArrayList & LinkedList

一个是线性表，一个是链表，一句话，随机查询尽量使用 ArrayList，ArrayList优于LinkedList，LinkedList还要移动指针，添加删除的操作LinkedList优于 ArrayList，ArrayList还要移动数据，不过这是理论性分析，事实未必如此，重要的是理解好数据结构。

## 缓存经常使用的对象

尽可能将经常使用的对象进行缓存，可以使用数组，或HashMap的容器来进行缓存，但这种方式可能导致系统占用过多的缓存，性能下降，推荐可以使用一些第三方的开源工具，如EhCache，Oscache进行缓存，他们基本都实现了FIFO/FLU等缓存算法。


## 尽早释放无用对象的引用

大部分情况下，方法局部引用变量所引用的对象会随着方法结束而变成垃圾，因此，大部分时候程序无需将局部引用变量显式设为null。
如：
``` bash
Public void doJob(){ 
	Object obj =new Object(); 
	……  
	Obj=null;  // 没有必要
}  
```
上面这个就没必要了，随着方法doJob()的执行完成，程序中obj引用变量的作用域会被gc回收。但是如果是改成下面：
``` bash
public void doJob(){ 
	Object obj =new Object(); 
	……  
	Obj=null;  // 有必要

	//以下执行耗时，耗内存操作，或调用耗时，耗内存的方法  
	……  
}  
```
这时候就有必要将obj赋值为null，可以尽早的释放对Object对象的引用。


## 使用final修饰符

带有final修饰符的类是不可派生的。在Java核心API中，有许多应用 final的例子，例如java.lang.String。为String类指定final防止了使用者覆盖length()方法。另外，如果一个类是 final的，则该类所有方法都是final的。Java编译器会寻找机会内联（inline）所有的final方法（这和具体的编译器实现有关）。此举能够使性能平均提高50%。

## 没有必要时请不用使用静态变量
使用Java的开发者都知道，当某个对象被定义为stataic变量所引用，这个对象所占有的内存将不会被回收。有时，开发者会将经常调用的对象或者变量定义为static，以便提高程序的运行性能。因此，不是常用到的对象或者变量，不要定义为static类型的变量，尤其是静态类对象的定义，一定要仔细考虑是否有必要。
如：
``` bash
public class X{   
    static Y a = new Y();   
}
```
类X创建了，没有被回收的话，静态变量a一直占用内存。

## 充分利用单例机制

使用单例可以减少对资源的加载，缩短运行的时间，提高系统效率。但是，单例并不是所有地方都适用于。简单来说，单例可以适用于以下两个方面：
1、 控制资源的使用，通过线程同步来控制资源的并发访问
2、 控制实例的产生，以达到节约资源的目的

## 在finally块中释放资源

程序中使用到的资源应当被释放，以避免资源泄漏。这最好在finally块中去做。不管程序执行的结果如何，finally块总是会执行的，以确保资源的正确关闭。